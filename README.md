# パート勤怠 & 扶養内シミュレーター（Webアプリ）

- 公開デモ（GitHub Pages）：**https://keijisuetsugu.github.io/part-attendance-system/**
- リポジトリ：**https://github.com/KeijiSuetsugu/part-attendance-system**

## できること（概要）
- 📅 カレンダー型の出勤簿（出勤/休みの切替、**30分刻み**の勤務時間入力）
- 🤖 **希望票テキストのAI解析 → カレンダーへ自動反映**  
  例）「扶養内。月・火・木のみ出勤。勤務時間4時間。祝日は休み」
- 💴 月次集計 / 年収見込み（103万/106万/130万ラインの進捗バー表示）
- 🗓 日本の祝日を自動取得（holidays-jp → 取得失敗時は Nager.Date でフォールバック）
- 👥 複数スタッフのタブ切替（スタッフごとに希望票も保存）
- ⬇️ CSV / Excel（.xlsx）エクスポート
- 📱 スマホ最適化（数字が見やすいバッジ、30分刻み入力、入力ミス防止）

## 動かし方（もっとも簡単）
### 1) 公開デモで試す（おすすめ）
1. **https://keijisuetsugu.github.io/part-attendance-system/** にアクセス  
2. そのまま操作（ローカル保存で次回もデータが残ります）

### 2) ローカル（PC）で試す
1. 本リポジトリを **Code → Download ZIP**  
2. 解凍して `index.html` を **ダブルクリックで開く**  
   - 祝日取得など外部通信あり：**インターネット接続は必要**  
   - もしブラウザのセキュリティで外部通信がブロックされる場合は  
     VS Code の **Live Server** 等の簡易サーバーで開いてください

## 使い方（基本）
1. 上部でスタッフ名・時給を入力 → **保存**
2. 月を切替（← →）して対象月に移動
3. **希望票テキスト**に要望を貼付 → 「AI解析して反映」  
   - 例：  
     - 扶養の範囲内。  
     - 月・火・木のみ出勤。  
     - 勤務時間は4時間。  
     - 祝日は休み。
4. カレンダーに **該当曜日が出勤**、**4.00h** が自動入力されます
5. 出力が必要なら **CSV** / **Excel** をクリック

## 主な解釈ルール（AI解析）
- **曜日**：`月火木` / `月〜金` / `火-金` / `平日（= 月〜土）` などを解釈  
- **時間**：`4時間` / `4h` / `4時間30分` / `1.5h` などを 30分単位に丸めて反映  
- **祝日**：`祝日は休み` があれば祝日は自動で休みに  
- **個別日**：`15日は休み`、`22日は入れる` も反映  
- **扶養**：文中に 103/106/130 万の指定があれば上限ラベルを表示（年収見込みバーの補足）

> 注意：本ツールの「AI解析」は **ブラウザ内のルールベース解析** です。個人情報は外部送信しません。

## フォルダ構成
/ (root)
├─ index.html … アプリ本体（HTML）
├─ script.js … ロジック（希望票AI解析・カレンダー・集計・出力）
├─ style.css … スタイル
└─ docs/
└─ report.md … 調査レポート（本プロジェクト説明）

## 技術要素
- バニラ **HTML/CSS/JavaScript** のみ（フレームワーク不使用）
- データ保存：ブラウザ **localStorage**
- 祝日API：`https://holidays-jp.github.io/api/v1/{year}/date.json`  
  フォールバック：`https://date.nager.at/api/v3/PublicHolidays/{year}/JP`
- Excel出力：CDNから `xlsx` を動的ロード

## セキュリティ / プライバシー
- 外部サーバーは不要。**入力データはブラウザ内に保存（localStorage）**  
- 祝日取得以外の外部通信なし  
- 機微情報のアップロード不要

## 既知の制限
- 祝日APIが長期ダウンした際は祝日バッジが表示できません  
- 超長文の希望票や特殊表現は想定外になる場合あり（なるべく例に沿った記述推奨）

## ライセンス
MIT（必要に応じて `LICENSE` を追加してください）

# 調査レポート：パート勤怠 & 扶養内シミュレーター（Webアプリ）

- 公開デモ：https://keijisuetsugu.github.io/part-attendance-system/
- リポジトリ：https://github.com/KeijiSuetsugu/part-attendance-system
- 作成者：末次　慶司
- 提出日：2025/10/05

---

## 1. 目的
- パートスタッフの**勤怠入力**と**扶養枠内（103/106/130万）での年収見込み**を、Webブラウザだけで簡便に実現。
- 人事・現場双方が**同じ画面**で入力・確認できる。
- **希望票テキストのAI解析**で、シフト希望から**自動でカレンダー反映**し、入力時間を削減。

## 2. 要件整理
- ブラウザのみで動作（インストール不要）
- スマホ/PC両対応、30分刻みで時間入力
- 祝日自動取得と休み設定
- 扶養ライン（103/106/130万）進捗の可視化
- CSV/XLSX出力（会計/給与ソフトへ渡せる）

## 3. 画面と主要機能
1. **スタッフ管理（タブ）**  
   - 複数スタッフを追加/削除/並び替え  
   - スタッフごとに**希望票テキストを保持**
2. **カレンダー出勤簿**  
   - 日ごとの「出勤/休み」切替  
   - 勤務時間は**30分単位**で直接入力  
   - 祝日は自動バッジ表示・休みに設定可能
3. **希望票→AI解析→自動反映**  
   - 例：「扶養内。月・火・木のみ出勤。勤務時間4時間。祝日は休み。」  
   - 解析後、**該当曜日が出勤・4.00h入力**まで自動化
4. **月次集計・年収見込み**  
   - 年収の進捗バー（103/106/130万ライン）  
5. **エクスポート**  
   - CSV / Excel（.xlsx）

## 4. 技術構成
- フロントエンド：バニラ HTML/CSS/JS  
- データ保存：localStorage（個人端末内）  
- 祝日API：  
  - 1次：`https://holidays-jp.github.io/api/v1/{year}/date.json`  
  - 2次：`https://date.nager.at/api/v3/PublicHolidays/{year}/JP`  
  （取得不可時は状態を表示）

## 5. セキュリティ・プライバシー
- 勤怠データはブラウザ内保存（localStorage）で**外部送信なし**  
- 祝日取得以外の外部アクセスなし

## 6. 導入・運用
- GitHub Pages（PAGES_URL）で公開 → 現場はURLを開くだけ  
- バージョン更新は `script.js` / `index.html` を更新しCommit → Pagesが自動反映

## 7. テスト観点（抜粋）
- 祝日取得：オンライン/オフライン時の表示  
- 希望票解析：曜日表記（`月火木`、`火-金`、`月〜土`）、時間表現（`4時間30分`/`1.5h`）、祝日休  
- 端末：PC（Chrome/Safari/Edge）、iPhone（Safari）、Android（Chrome）  
- CSV/XLSX：Excel/スプレッドシートで文字化け・桁落ちがない

## 8. 既知のリスク/課題
- 長文・曖昧表現の解釈限界（将来、自然言語処理の強化余地あり）  
- 祝日APIが長期間停止するとバッジ表示が不可

## 9. 今後の拡張
- 週・月単位のシフト自動最適化（複数スタッフ間の割当バランス）  
- 管理者アカウント＋共有（クラウド保存）  
- 休憩自動控除・深夜/残業割増の理論値計算

---

## 付録
- 使い方クイック手順：  
  1) スタッフ作成＆時給入力 → 2) 希望票貼付 → 3) **AI解析して反映** → 4) 必要に応じて微調整 → 5) CSV/XLSX出力

# 勤怠カレンダー & 扶養内シミュレーター（提出用レポート）

- 提出先：株式会社AX 代表　石綿文太　様
- 提出者：末次　慶司
- 提出日：2025-10-06

---

## 1. 背景・目的
パートスタッフの勤怠作成は、各人の「扶養範囲希望」や「曜日・時間の希望」を反映しつつ、法定上限や社内ルールに配慮した調整が求められます。  
本プロトタイプは、**希望票（日本語テキスト）を解析し、月間カレンダーへ自動反映**することで、**シフト作成の時間短縮**と**人的ミス削減**を目的としています。あわせて、**103/106/130万円ライン**を基に**年収見込みの可視化**を行い、早期の過不足把握を支援します。

---

## 2. 要求整理（御社ニーズとの対応表）
| 御社要望 | 本成果物での対応 |
|---|---|
| 業務効率化のアイデア出しと試作実装 | 希望票テキスト→自動割付、月次集計、年収見込み、エクスポートを1画面に統合 |
| 題材は業務効率化に関連 | 人事・勤怠領域（パート勤怠） |
| 納期は申告制 | 今回は **10月末** を申告（本レポート時点で可動） |
| 成果物の提出（GitHub/レポート/動画） | 本レポート、GitHubリポジトリ（READMEに手順）、デモ動画台本を同梱 |

---

## 3. 提案ソリューション概要
- **機能**  
  - **AI的テキスト解析による自動割付**  
    - 例：「扶養の範囲内」「月・火・木のみ出勤」「勤務時間は4時間」「祝日は休み」「15日は休み、22日は入れる」  
    - 排他的指定（〜のみ／〜だけ／〜以外／**平日のみ**）を解釈し、**他曜日を自動で休みに**設定（上書き適用時）。
    - 0.25時間刻み（15分単位）対応。小数（4.5h）・時間帯（9:00-13:30）表記も自動換算。
  - **カレンダー編集**：各日「出勤/休み」切替、時間は数値入力（0.25刻み）。
  - **見込み管理**：103/106/130万円＋**カスタムA/B**ラインの進捗バー表示。
  - **祝日自動取得**：国内祝日をAPIから取得（30日キャッシュ）→祝日を休みに反映可能。
  - **前月→今月コピー**：空欄のみ埋める／全上書き。
  - **CSV / Excel（.xlsx）出力**：月単位／全スタッフ集計をダウンロード。
- **非機能要件**  
  - 100%フロントエンド（**サーバ不要**）／ブラウザ動作のみ。  
  - データ保存は **ブラウザの localStorage**（端末内）。

---

## 4. 画面フロー（運用イメージ）
1. **スタッフ選択**：タブで切替／追加・削除・並び替え、時給を保存。  
2. **対象月選択**：前月／翌月／年月ピッカー。  
3. **希望票貼付 → 「AI解析して反映」**：  
   - 解析結果がそのまま**カレンダーへ反映**（出勤/休み、勤務時間）。  
   - 「既存の入力を優先（空欄のみ埋める）」をONにすると、手入力値を保持し不足分だけ補完。  
4. **月次集計 & 年収見込み**：進捗バーで扶養ライン到達度を把握。  
5. **年間サマリー**：各月の金額・時間を俯瞰。  
6. **エクスポート**：CSV（今月／全体）・Excel（今月）をダウンロード。

---

## 5. 技術構成
- **構成**：`index.html` / `style.css` / `script.js` / `docs/report.md`  
- **主要ライブラリ**：`xlsx`（CDN経由、Excel出力に利用）  
- **祝日API**：  
  - 第1候補：`holidays-jp.github.io`  
  - フォールバック：`date.nager.at`  
  - **キャッシュ**：30日（`localStorage`）  
- **データ保存**：`localStorage`（端末内のみ。サーバ送信なし）

---

## 6. セキュリティ・個人情報の取り扱い
- **保存範囲**：氏名・勤怠（勤務日/時間）・時給が端末内 `localStorage` に保存されます。  
- **推奨運用**：  
  - 共用PCは非推奨。利用時は**専用ブラウザプロファイル**や**端末ログイン分離**を推奨。  
  - 退職者データは画面の「データ初期化」／スタッフ削除で速やかに破棄。  
- **通信**：祝日API・CDNへのアクセスはHTTPS。勤怠データは外部送信しません。  
- **留意**：本ツールは給与計算や法的判定の**参考指標**であり、税務・社保適用の最終判断は所管部署・顧問へご確認ください。

---

## 7. 成果物一覧（提出物）
1. **GitHub リポジトリ**：README に環境構築・操作手順を記載  
2. **本レポート（`docs/report.md`）**：背景、要件、設計、運用、セキュリティ、効果  
3. **（任意）デモ動画**：3分以内（台本テンプレ同梱）

---

## 8. 期待効果（概算）
- **シフト初版作成時間**：1名あたり30–60分 → **5–10分**（希望票による自動割付）  
- **ミス削減**：祝日や扶養ライン見込みの見落とし低減  
- **可視化**：年収進捗バーにより早期警戒が可能

※ 効果は運用ルール・スタッフ数により変動

---

## 9. テスト観点（抜粋）
- 曜日指定：  
  - 「月火木のみ」「火以外」「平日のみ」「土日休み」  
- 時間指定：  
  - 「4時間」「4.5h」「9:00-13:30」→ 0.25刻み換算  
- 個別日付：  
  - 「15日は休み」「22日は入れる」  
- 扶養ライン：  
  - 時給設定ありの状態で、103/106/130/カスタムA/B の進捗表示  
- 上書き挙動：  
  - 「既存優先」ON/OFF と排他的指定（〜のみ）時の**他曜日リセット**動作  
- エクスポート：  
  - CSV（BOM付）文字化け無し、Excel（.xlsx）を開いて金額・時間が一致

---

## 10. 導入・運用ステップ
1. **GitHub Pages 公開**（任意）：`Settings > Pages > main / root` を選択  
2. **端末配布**：公開URLまたはZIP配布（HTML直開きでも可）  
3. **運用**：人事担当が毎月、希望票貼付→反映→調整→出力  
4. **保守**：ルール追加は `script.js` の `parseWishText` / `planAutoAssignment` を拡張

---

## 11. 既知の課題・今後の拡張
- 多様な言い回し（自然言語）のさらなる網羅  
- 週/日単位の上限（例：1日6時間までなど）GUI化  
- 休憩・残業・深夜・割増等の制度反映  
- 役割/スキルに基づく**複数人同時割付**（最適化アルゴリズム）

---

## 12. 付録：操作クイックガイド
1) スタッフ名・時給を保存  
2) 希望票をコピペして **「AI解析して反映」**  
3) 祝日が自動で休みに（祝日休み希望時）  
4) 月次集計・年収見込みを確認  
5) **CSV/Excel** をダウンロードし共有
